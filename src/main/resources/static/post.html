<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">

    <title>게시판</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@500&display=swap" rel="stylesheet">
    <!--Custom styles-->
    <link rel="stylesheet" type="text/css" href="styles.css">

    <script>
        // 사용자가 내용을 올바르게 입력하였는지 확인합니다.
        function isValidContents(contents) {
            if (contents === '') {
                alert('내용을 입력해주세요');
                return false;
            }
            if (contents.trim().length > 140) {
                alert('공백 포함 140자 이하로 입력해주세요');
                return false;
            }
            return true;
        }

        // 메모를 생성합니다.
        function writePost() {
            let title = $('#title').val();
            let username = $('#username').val();
            let contents = $('#contents').val();

            if (isValidContents(contents) === false) {
                return;
            }

            let data = {'title': title, 'username': username, 'contents': contents};
            
            $.ajax({
                type: "POST",
                url: "/board",
                contentType: "application/json", // JSON 형식으로 전달함을 알리기
                data: JSON.stringify(data),
                success: function (response) {
                    alert("메시지가 성공적으로 작성되었습니다!");
                    window.location.href = "/index.html";
                }
            })
        }

        // 수정 버튼을 눌렀을 때, 기존 작성 내용을 textarea 에 전달합니다.
        // 숨길 버튼을 숨기고, 나타낼 버튼을 나타냅니다.
        function editPost(id) {
            showEdits(id);
            let contents = $(`#${id}-contents`).text().trim();
            $(`#${id}-textarea`).val(contents);
        }

        function showEdits(id) {
            $(`#${id}-editarea`).show();
            $(`#${id}-submit`).show();
            $(`#${id}-delete`).show();

            $(`#${id}-contents`).hide();
            $(`#${id}-edit`).hide();
        }

        function hideEdits(id) {
            $(`#${id}-editarea`).hide();
            $(`#${id}-submit`).hide();
            $(`#${id}-delete`).hide();

            $(`#${id}-contents`).show();
            $(`#${id}-edit`).show();
        }

        function onClickMainPage() {
            window.location.href = "/index.html";
        }

    </script>
</head>

<body>
<div class="background-header">

</div>
<div class="background-body">

</div>
<div class="wrap">
    <div class="header">
        <h2>My blog</h2>
        <p>
            글쓰기
        </p>
    </div>


    <div id="post-box" class="form-post">
        <div>
            <div class="form-group">
                <input id="title" class="form-control" placeholder="제목을 입력해주세요.">
            </div>
            <div class="form-group">
                <input id="username" class="form-control" placeholder="작성자명을 입력해주세요."/>
            </div>
            <div class="form-group">
                <input id="contents" class="form-control" rows="3" placeholder="내용을 입력해주세요."/>
            </div>
            <button type="button" class="btn btn-primary" onclick="writePost()">기사저장</button>
        </div>
    </div>

    <div id="cards-box" class="area-read">
    </div>
    <div id="main-page-button-box" style="text-align: right">
        <button id="main-page-button" onclick="onClickMainPage()" type="button" style="width: 150px; height: 30px">목록으로
            돌아가기
        </button>
    </div>

</div>
</body>
</html>